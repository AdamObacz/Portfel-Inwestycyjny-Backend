# Environment Configuration Reference

## File: `.env`

Ten plik zawiera wszystkie zmienne ≈õrodowiskowe dla backendu.

### üîç Jak u≈ºywaƒá

Zmienne sƒÖ automatycznie ≈Çadowane przez `@dotenvx/dotenvx` w `src/index.ts`.

Dostƒôp do zmiennych w kodzie:
```typescript
const port = process.env.MAIN_PORT; // 8000
const secret = process.env.SESSION_SECRET;
```

---

## üìù Konfiguracja

### Server Configuration

```env
# Port na kt√≥rym serwer nas≈Çuchuje
MAIN_PORT=8000

# Environment: development, production, staging
NODE_ENV=development

# CORS - dozwolone pochodzenia (comma-separated)
MAIN_ALLOWED_ORIGINS=http://localhost:3000
```

**Production example:**
```env
MAIN_PORT=8000
NODE_ENV=production
MAIN_ALLOWED_ORIGINS=https://myapp.com,https://www.myapp.com
```

---

### Redis Configuration

```env
# Host gdzie uruchomiony jest Redis
REDIS_HOST=localhost

# Port Redis (default 6379)
REDIS_PORT=6379

# Has≈Ço do Redis (optional, je≈õli Redis wymaga auth)
REDIS_PASSWORD=
```

**Production example:**
```env
REDIS_HOST=redis.example.com
REDIS_PORT=6379
REDIS_PASSWORD=super-strong-password-here
```

---

### Session & Cookie Security

```env
# Secret dla express-session (dla podpisywania sessionId)
SESSION_SECRET=your-session-secret-key-change-this

# Secret dla cookie-parser (dla podpisywania cookies)
COOKIE_SECRET=your-cookie-secret-key-change-this
```

‚ö†Ô∏è **WA≈ªNE**: W production u≈ºyj silnych, losowych string√≥w!

```bash
# Generuj silne sekrety (Node.js)
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

**Production example:**
```env
SESSION_SECRET=a8f3c4e2b1d9f6a7e5c2b9d3f1a8e4c6b2d9f3a1e5c7b9d2f4a8e1c3b5d7f9
COOKIE_SECRET=f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0
```

---

### Database Configuration (PostgreSQL)

```env
# Host PostgreSQL
DB_HOST=localhost

# Port PostgreSQL (default 5432)
DB_PORT=5432

# U≈ºytkownik PostgreSQL
DB_USER=postgres

# Has≈Ço u≈ºytkownika PostgreSQL
DB_PASSWORD=postgres

# Nazwa bazy danych
DB_NAME=portfolio_db

# Dialekt (always postgres for this setup)
DB_DIALECT=postgres
```

**Production example:**
```env
DB_HOST=db.example.com
DB_PORT=5432
DB_USER=portfolio_user
DB_PASSWORD=secure-db-password-here
DB_NAME=portfolio_production
DB_DIALECT=postgres
```

---

## üöÄ Setup dla Development

```bash
# Skopiuj .env i ustaw zmienne
cp .env.example .env

# Edit .env z warto≈õciami lokalnymi
nano .env  # lub u≈ºyj edytora
```

### Minimal .env dla dev:
```env
MAIN_PORT=8000
NODE_ENV=development
MAIN_ALLOWED_ORIGINS=http://localhost:3000

REDIS_HOST=localhost
REDIS_PORT=6379

SESSION_SECRET=dev-secret-no-need-to-change
COOKIE_SECRET=dev-cookie-secret

DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=portfolio_db
```

---

## üîí Setup dla Production

```env
MAIN_PORT=8000
NODE_ENV=production
MAIN_ALLOWED_ORIGINS=https://myapp.com,https://www.myapp.com

REDIS_HOST=redis.myapp.com
REDIS_PORT=6379
REDIS_PASSWORD=very-strong-redis-password

SESSION_SECRET=<generated-random-string-32-chars>
COOKIE_SECRET=<generated-random-string-32-chars>

DB_HOST=db.myapp.com
DB_PORT=5432
DB_USER=prod_user
DB_PASSWORD=<strong-db-password>
DB_NAME=portfolio_prod
DB_DIALECT=postgres
```

---

## üîê Security Considerations

### ‚ùå NIGDY nie commituj `.env` do git!
```bash
# .gitignore powinien zawieraƒá:
.env
.env.local
.env.*.local
```

### ‚úÖ DO:
- [ ] U≈ºyj `.env.example` jako template
- [ ] Commituj `.env.example` (bez warto≈õci)
- [ ] Zabezpiecz dostƒôp do `.env` (chmod 600)
- [ ] Rotuj sekrety regularnie
- [ ] U≈ºywaj `.env.local` dla local overrides

### ‚ùå NIE:
- [ ] Nie commituj `.env` z production sekrety
- [ ] Nie deployuj hardcoded sekrety
- [ ] Nie sharuj `.env` w komunikatorach

---

## üìã Checklist

### Development
- [ ] `.env` istnieje w root
- [ ] REDIS_HOST i DB_HOST sƒÖ dostƒôpne
- [ ] `npm run dev` uruchamia siƒô bez b≈Çƒôd√≥w
- [ ] Port 8000 nie jest zajƒôty

### Production
- [ ] `NODE_ENV=production`
- [ ] SESSION_SECRET i COOKIE_SECRET to losowe 32+ znaki
- [ ] REDIS_PASSWORD jest ustawiony
- [ ] DB_PASSWORD jest silny (12+ znak√≥w)
- [ ] MAIN_ALLOWED_ORIGINS sƒÖ ustawione na production domeny
- [ ] SSL certyfikat skonfigurowany
- [ ] Backup bazy danych jest ustawiony
- [ ] Monitoring jest w≈ÇƒÖczony

---

## üêõ Debugging

### Jak sprawdziƒá zmienne?

```bash
# W terminalu (nie bezpieczne!)
echo $MAIN_PORT

# W Node.js safe way
node -e "require('dotenv').config(); console.log(process.env.MAIN_PORT)"
```

### Problemy?

1. **"Cannot find variable REDIS_HOST"**
   - ‚úÖ Sprawd≈∫ czy `.env` istnieje
   - ‚úÖ Restart `npm run dev`

2. **"Connection refused" na Redis**
   - ‚úÖ Sprawd≈∫ czy Redis jest uruchomiony
   - ‚úÖ Sprawd≈∫ `REDIS_HOST` i `REDIS_PORT`

3. **"Connection refused" na PostgreSQL**
   - ‚úÖ Sprawd≈∫ czy PostgreSQL jest uruchomiony
   - ‚úÖ Sprawd≈∫ `DB_HOST`, `DB_PORT`, `DB_USER`, `DB_PASSWORD`

4. **"CORS error"**
   - ‚úÖ Sprawd≈∫ czy frontend URL jest w `MAIN_ALLOWED_ORIGINS`
   - ‚úÖ Restart serwera po zmianie `.env`

---

## üìö Referenceemplate

Plik `.env.example` (do commitu):
```env
# Server
MAIN_PORT=8000
NODE_ENV=development
MAIN_ALLOWED_ORIGINS=http://localhost:3000

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# Session & Cookies
SESSION_SECRET=change-this-in-production
COOKIE_SECRET=change-this-in-production

# Database
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=portfolio_db
DB_DIALECT=postgres
```

---

**Last Updated**: 2025-11-17
**Status**: ‚úÖ Ready for use
